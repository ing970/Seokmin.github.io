---
title:  "데이터프레임 합치기"
categories:
    - Dataframejoin #똑같이 맞추기
tags:
    - python, pandas, dataframejoin
toc: true
toc_sticky: true
toc_label: "목차"
---



# 데이터프레임 합치기
- 두개 이상의 DataFrame을 합쳐 하나의 DataFrame으로 만든다.

![image.png](attachment:image.png)

- **수직결합**
    - 단순결합으로 여러개의 DataFrame들의 같은 컬럼끼리 수직으로 합친다.
- **수평결합**
    - 연관성 있는 여러 데이터를 하나로 합쳐서 조회하는 JOIN 처리를 한다.
    - 합치려는 DataFrame의 index 나 특정 컬럼의 값이 같은 행 끼리 합친다.

## 데이터셋 읽기
- stocks_2016.csv, stocks_2017.csv, stocks_2018.csv : 년도별 보유 주식
- stocks_info.csv : 주식 정보


```python
import pandas as pd
df1 = pd.read_csv('data/stocks_2016.csv')
df2 = pd.read_csv('data/stocks_2017.csv')
df3 = pd.read_csv('data/stocks_2018.csv')
df4 = pd.read_csv('data/stocks_info.csv')
```


```python
file_names = ['2016', '2017', '2018', 'info']
stock_2016, stock_2017, stock_2018, stock_info = [pd.read_csv(f"data/stocks_{txt}.csv") for txt in file_names]
```


```python
stock_2016.shape, stock_2017.shape, stock_2018.shape, stock_info.shape
```




    ((3, 4), (6, 4), (3, 4), (8, 2))




```python
stock_2016
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_2017
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GE</td>
      <td>100</td>
      <td>30</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>IBM</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SLB</td>
      <td>20</td>
      <td>55</td>
      <td>85</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TXN</td>
      <td>500</td>
      <td>15</td>
      <td>23</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TSLA</td>
      <td>100</td>
      <td>100</td>
      <td>300</td>
    </tr>
  </tbody>
</table>
</div>




```python
/Users/seokminlee/Desktop/mose/ing970_github_io/ing970.github.io/_includes/nav_list_main
/Users/seokminlee/Desktop/mose/ing970_github_io/ing970.github.io/_pages/categories/category-matplotlib.md
/Users/seokminlee/Desktop/mose/ing970_github_io/ing970.github.io/_pages/categories/category-Pd/category-Pd5.md
/Users/seokminlee/Desktop/mose/ing970_github_io/ing970.github.io/_pages/categories/category-Pd/category-Pd4.md
/Users/seokminlee/Desktop/mose/ing970_github_io/ing970.github.io/_config.yml
/Users/seokminlee/Desktop/mose/ing970_github_io/ing970.github.io/_data/navigation.ymlstock_info
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>Apple Inc</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>Tesla Inc</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>Walmart Inc</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GE</td>
      <td>General Electric</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IBM</td>
      <td>IBM(International Business Machines Co)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SLB</td>
      <td>Schlumberger Limited.</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TXN</td>
      <td>Texas Instruments Incorporated</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AMZN</td>
      <td>Amazon.com, Inc</td>
    </tr>
  </tbody>
</table>
</div>



## concat() 이용
- 수직, 수평 결합 모두 지원한다.
- 하나의 데이터셋을 여러 DataFrame으로 나눈 것을 하나의 DataFrame으로 합칠 때 사용한다.

- 수직 결합 (행이 늘어나도록 합친다.)
    - **컬럼명이 같은 열끼리 합친다.**
    - 같은 column 명이 없는 열들도 결과 DataFrame에 들어간다.(default)
        - full outer join개념

- 수평결합(열이 늘어나도록 합친다.)
    - **index명이 같은 행 끼리 합친다.** (equi-join)
    - 같은 index명이 없는 행들도 결과 DataFrame에 들어간다.(default)
        - full outer join

- pd.concat(objs,  [, key=리스트]), axis=0, join='outer' )
    - 매개변수
        - objs: 합칠 DataFrame들을 리스트로 전달
        - keys=[] 를 이용해 합친 행들을 구분하기 위한 다중 인덱스 처리
        - axis
            - 0 또는 index : 수직결합
            - 1 또는 columns : 수평결합
        - join: 
            - 합치는 방식으로 다음 문자열을 값으로 설정한다.
                - 'outer'(기본값): full outer join
                - 'inner': inner join (동일한 index명, column명 끼리 합친다.)

> ### 조인(join)
> - 여러 데이터프레임에 흩어져 있는 정보 중 필요한 정보만 모아서 결합하기 위한 것.
> - 두개 이상의 데이터프레임을 특정 컬럼(열)의 값이 같은 행 끼리 수평 결합하는 것.
> - Inner Join, Left Outer Join, Right Outer Join, Full Outer Join


```python
# pd.concat([stock_2016, stock_2017, stock_2018])
# pd.concat([stock_2016, stock_2017, stock_2018, stock_info], 
#           join='inner' # 양쪽에 모두 있는 것들만 붙인다.=> inner
#          )
pd.concat([stock_2016, stock_2017, stock_2018], 
          axis=1,  # 수평결합 - 1번 축 방향으로 합친다. => 행 index이름이 같은 것 끼리 합친다.
          join='inner'
         )
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
      <td>AAPL</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
      <td>AAPL</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
      <td>GE</td>
      <td>100</td>
      <td>30</td>
      <td>40</td>
      <td>AMZN</td>
      <td>8</td>
      <td>900</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
      <td>IBM</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
      <td>TSLA</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
result = pd.concat([stock_2016, stock_2017, stock_2018])
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GE</td>
      <td>100</td>
      <td>30</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>IBM</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SLB</td>
      <td>20</td>
      <td>55</td>
      <td>85</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TXN</td>
      <td>500</td>
      <td>15</td>
      <td>23</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TSLA</td>
      <td>100</td>
      <td>100</td>
      <td>300</td>
    </tr>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AMZN</td>
      <td>8</td>
      <td>900</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TSLA</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
result.iloc[6] # 열 조회
```




    Symbol    SLB
    Shares     20
    Low        55
    High       85
    Name: 3, dtype: object




```python
result.loc[2]  # 열 조회
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
    <tr>
      <th>2</th>
      <td>IBM</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TSLA</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
result2 = pd.concat([stock_2016, stock_2017, stock_2018]
                   , ignore_index=True) 
# 대상 dataframe들의 index이름은 무시하고(버리고) 붙인다. ==> index명은 0 ~ 1씩 자동증가하는 값(RangeIndex)으로 변경.
result2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AAPL</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GE</td>
      <td>100</td>
      <td>30</td>
      <td>40</td>
    </tr>
    <tr>
      <th>5</th>
      <td>IBM</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SLB</td>
      <td>20</td>
      <td>55</td>
      <td>85</td>
    </tr>
    <tr>
      <th>7</th>
      <td>TXN</td>
      <td>500</td>
      <td>15</td>
      <td>23</td>
    </tr>
    <tr>
      <th>8</th>
      <td>TSLA</td>
      <td>100</td>
      <td>100</td>
      <td>300</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AAPL</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>10</th>
      <td>AMZN</td>
      <td>8</td>
      <td>900</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>11</th>
      <td>TSLA</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
result3 = pd.concat([stock_2016, stock_2017, stock_2018], 
                    keys=['2016년', '2017년', '2018년']) # 각각의 DataFrame을 구분할 수있는  index를 추가. (멀티 index)
result3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">2016년</th>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">2017년</th>
      <th>0</th>
      <td>AAPL</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GE</td>
      <td>100</td>
      <td>30</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>IBM</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SLB</td>
      <td>20</td>
      <td>55</td>
      <td>85</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TXN</td>
      <td>500</td>
      <td>15</td>
      <td>23</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TSLA</td>
      <td>100</td>
      <td>100</td>
      <td>300</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2018년</th>
      <th>0</th>
      <td>AAPL</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AMZN</td>
      <td>8</td>
      <td>900</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TSLA</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
result3.loc['2016년']      # 2016년 DataFrame 추출 가능.
result3.loc[("2018년", 0)] # 2018년의 0번 인덱스 추출.
```




    Symbol    AAPL
    Shares      40
    Low        135
    High       170
    Name: (2018년, 0), dtype: object



## 조인을 통한 DataFrame 합치기
- 연관성있는 둘 이상의 DataFrame을 하나로 합친다.
    - ex) 고객과 주문정보, 교수와 수업정보, 직원과 부서정보
- join()
    - **2개 이상**의 DataFrame을 조인할 때 사용
- merge()
    - **2개의** DataFrame의 조인만 지원

### join()
- dataframe객체.join(others, how='left', lsuffix='', rsuffix='') 
- `df_A.join(df_b)`, `df_A.join([df_b, df_c, df_d])`
- 두개 이상의 DataFrame들을 조인 할 수 있다.
    - **조인 기준**: index가 같은 값인 행끼리 합친다. (equi-join)
    - **조인 기본 방식**: Left Outer Join
- 매개변수
    - lsuffix, rsuffix
        - 조인 대상 DataFrame에 같은 이름의 컬럼이 있으면 에러 발생.
        - 같은 이름이 있는 경우 붙일 접미어 지정
    - how :조인방식. 'left', 'right', 'outer', 'inner'. left가 기본
        


```python
stock_info.join(stock_2017, lsuffix="_info", rsuffix='_2016')
# index 이름이 같은 행끼리 join => 이 데이터프레임들은 Symbol 컬럼값이 같은 행끼리 join 해야된다.
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol_info</th>
      <th>Name</th>
      <th>Symbol_2016</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>Apple Inc</td>
      <td>AAPL</td>
      <td>50.0</td>
      <td>120.0</td>
      <td>140.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>Tesla Inc</td>
      <td>GE</td>
      <td>100.0</td>
      <td>30.0</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>Walmart Inc</td>
      <td>IBM</td>
      <td>87.0</td>
      <td>75.0</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GE</td>
      <td>General Electric</td>
      <td>SLB</td>
      <td>20.0</td>
      <td>55.0</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IBM</td>
      <td>IBM(International Business Machines Co)</td>
      <td>TXN</td>
      <td>500.0</td>
      <td>15.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SLB</td>
      <td>Schlumberger Limited.</td>
      <td>TSLA</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>300.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TXN</td>
      <td>Texas Instruments Incorporated</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AMZN</td>
      <td>Amazon.com, Inc</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_info.set_index("Symbol").join(stock_2017.set_index("Symbol"))
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
    <tr>
      <th>Symbol</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AAPL</th>
      <td>Apple Inc</td>
      <td>50.0</td>
      <td>120.0</td>
      <td>140.0</td>
    </tr>
    <tr>
      <th>TSLA</th>
      <td>Tesla Inc</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>300.0</td>
    </tr>
    <tr>
      <th>WMT</th>
      <td>Walmart Inc</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>GE</th>
      <td>General Electric</td>
      <td>100.0</td>
      <td>30.0</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>IBM</th>
      <td>IBM(International Business Machines Co)</td>
      <td>87.0</td>
      <td>75.0</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>SLB</th>
      <td>Schlumberger Limited.</td>
      <td>20.0</td>
      <td>55.0</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>TXN</th>
      <td>Texas Instruments Incorporated</td>
      <td>500.0</td>
      <td>15.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>AMZN</th>
      <td>Amazon.com, Inc</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
join_df = stock_info.set_index("Symbol").join(stock_2017.set_index("Symbol"),
                                   how='inner')  # inner join
join_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
    <tr>
      <th>Symbol</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AAPL</th>
      <td>Apple Inc</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
    </tr>
    <tr>
      <th>TSLA</th>
      <td>Tesla Inc</td>
      <td>100</td>
      <td>100</td>
      <td>300</td>
    </tr>
    <tr>
      <th>GE</th>
      <td>General Electric</td>
      <td>100</td>
      <td>30</td>
      <td>40</td>
    </tr>
    <tr>
      <th>IBM</th>
      <td>IBM(International Business Machines Co)</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
    </tr>
    <tr>
      <th>SLB</th>
      <td>Schlumberger Limited.</td>
      <td>20</td>
      <td>55</td>
      <td>85</td>
    </tr>
    <tr>
      <th>TXN</th>
      <td>Texas Instruments Incorporated</td>
      <td>500</td>
      <td>15</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_2017.set_index('Symbol').join(stock_info.set_index('Symbol'),
                                    how='right')  #right outer join (stock_info의 모든 행이 다 join 된다.)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
      <th>Name</th>
    </tr>
    <tr>
      <th>Symbol</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AAPL</th>
      <td>50.0</td>
      <td>120.0</td>
      <td>140.0</td>
      <td>Apple Inc</td>
    </tr>
    <tr>
      <th>TSLA</th>
      <td>100.0</td>
      <td>100.0</td>
      <td>300.0</td>
      <td>Tesla Inc</td>
    </tr>
    <tr>
      <th>WMT</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Walmart Inc</td>
    </tr>
    <tr>
      <th>GE</th>
      <td>100.0</td>
      <td>30.0</td>
      <td>40.0</td>
      <td>General Electric</td>
    </tr>
    <tr>
      <th>IBM</th>
      <td>87.0</td>
      <td>75.0</td>
      <td>95.0</td>
      <td>IBM(International Business Machines Co)</td>
    </tr>
    <tr>
      <th>SLB</th>
      <td>20.0</td>
      <td>55.0</td>
      <td>85.0</td>
      <td>Schlumberger Limited.</td>
    </tr>
    <tr>
      <th>TXN</th>
      <td>500.0</td>
      <td>15.0</td>
      <td>23.0</td>
      <td>Texas Instruments Incorporated</td>
    </tr>
    <tr>
      <th>AMZN</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Amazon.com, Inc</td>
    </tr>
  </tbody>
</table>
</div>




```python
# stock_info + stock_2016, 2017, 2018
# stock_info.join([stock_2016, stock_2017, stock_2018], lsuffix='_info', rsuffix='_2000')
stock_2016.add_suffix("_접미어")  # 뒤에 붙는 명령어
stock_2016.add_prefix("접두어_")  # 앞에 붙는 명령어
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>접두어_Symbol</th>
      <th>접두어_Shares</th>
      <th>접두어_Low</th>
      <th>접두어_High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_2016_2 = stock_2016.set_index('Symbol').add_suffix("_2016")
stock_2017_2 = stock_2017.set_index('Symbol').add_suffix("_2017")
stock_2018_2 = stock_2018.set_index('Symbol').add_suffix("_2018")
stock_info_2 = stock_info.set_index("Symbol")
```


```python
stock_info_2.join([stock_2016_2, stock_2017_2, stock_2018_2]
                  , how='inner'
                 )
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Shares_2016</th>
      <th>Low_2016</th>
      <th>High_2016</th>
      <th>Shares_2017</th>
      <th>Low_2017</th>
      <th>High_2017</th>
      <th>Shares_2018</th>
      <th>Low_2018</th>
      <th>High_2018</th>
    </tr>
    <tr>
      <th>Symbol</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AAPL</th>
      <td>Apple Inc</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>TSLA</th>
      <td>Tesla Inc</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
      <td>100</td>
      <td>100</td>
      <td>300</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>



### merge()
- `df_a.merge(df_b)`
- 두개의 DataFrame간의 조인만 가능하다.
    - **조인 기준**
        - **같은 컬럼명**을 기준으로 equi-join을 하는 것이 기본이다.
        - **조인기준을 다양하게 정할 수 있다.**
            - 컬럼, index등을 기준으로 같은 행끼리 join 하도록 설정할 수 있다.
    - **조인 기본 방식**
        - inner join
        - how 매개변수를 이용해 변경이 가능하다.
- `dataframe.merge(합칠dataframe, how='inner', on=None, left_on=None, right_on=None, left_index=False, right_index=False)`  
- 매개변수
    - on : 같은 컬럼명이 여러개일때 join 대상 컬럼을 선택
    - right_on, left_on : 조인할 때 사용할 왼쪽,오른쪽 Dataframe의 컬럼명. 
    - left_index, right_index: 조인 할때 index를 사용할 경우 True로 지정 
    - how : 조인 방식.  'left', 'right', 'outer', 'inner'. 기본: inner 
    - suffixes: 두 DataFrame에 같은 이름의 컬럼명이 있을 경우 구분을 위해 붙인 접미어를 리스트로 설정
        - 생략시 x, y를 붙인다.       


```python
stock_2016.merge(stock_info, how='right')  #  같은 컬럼명(Symbol)의 값을 기준으로 join 
stock_info.merge(stock_2016, how='left')   # 기본 join 방식:  inner join
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Name</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>Apple Inc</td>
      <td>80.0</td>
      <td>95.0</td>
      <td>110.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>Tesla Inc</td>
      <td>50.0</td>
      <td>80.0</td>
      <td>130.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>Walmart Inc</td>
      <td>40.0</td>
      <td>55.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GE</td>
      <td>General Electric</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IBM</td>
      <td>IBM(International Business Machines Co)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SLB</td>
      <td>Schlumberger Limited.</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TXN</td>
      <td>Texas Instruments Incorporated</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AMZN</td>
      <td>Amazon.com, Inc</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_info.merge(stock_2016_2, 
                 left_on='Symbol',   # 왼쪽(stock_info) 에서는 Symbol 컬럼을 join 기준.
                 right_index=True   # 오른쪽(stock_2016_2) 에서는 index이름을 join 기준.
                )
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Name</th>
      <th>Shares_2016</th>
      <th>Low_2016</th>
      <th>High_2016</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>Apple Inc</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>Tesla Inc</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>Walmart Inc</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_2016_2.merge(stock_info, 
                   left_index=True, right_on='Symbol')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Shares_2016</th>
      <th>Low_2016</th>
      <th>High_2016</th>
      <th>Symbol</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80</td>
      <td>95</td>
      <td>110</td>
      <td>AAPL</td>
      <td>Apple Inc</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>80</td>
      <td>130</td>
      <td>TSLA</td>
      <td>Tesla Inc</td>
    </tr>
    <tr>
      <th>2</th>
      <td>40</td>
      <td>55</td>
      <td>70</td>
      <td>WMT</td>
      <td>Walmart Inc</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_2016.merge(stock_2018, on='Symbol',  # 같은 이름의 컬럼이 여러개 일때 JOIN 기준 컬럼을 일부만 선택할때 on을 사용.
                 suffixes=["_2016", "_2018"]
                )
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares_2016</th>
      <th>Low_2016</th>
      <th>High_2016</th>
      <th>Shares_2018</th>
      <th>Low_2018</th>
      <th>High_2018</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_2016
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_2018
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AMZN</td>
      <td>8</td>
      <td>900</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TSLA</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>



- 하나의 데이터셋을 어떤 특정행 또튼 특정열을 기준으로 단순해 분리 한 경우를 합치는 경우 concat() 사용
    - 수직 결합일 경우는 concat()을 사용해야 한다. 
- 서로 연관성 있는 다른 데이터셋을 결합해서 보는 경우 join(), merge()를 사용한다. (Join)
    - **두 개 이상의** DataFrame을 조인할 때는 하는 경우 : join() 사용
    - 두개의 DataFrame을 조인할 때는 **merge()** 를 사용한다. => 컨트롤이 편하다.

 # <b style='font-size:2em'>TODO</b>


```python
import os
os.listdir('data')
```




    ['customer.csv',
     'diamonds.csv',
     'flights.csv',
     'movie.csv',
     'order.csv',
     'qna.csv',
     'state_fruit.csv',
     'stocks_2016.csv',
     'stocks_2017.csv',
     'stocks_2018.csv',
     'stocks_info.csv']



### 1. data/customer.csv, data/order.csv, data/qna.csv 를 DataFrame으로 읽으시오.


```python
import pandas as pd
file_names = ["customer", "order", "qna"]
customer, order, qna = [pd.read_csv(f"data/{file_name}.csv") for file_name in file_names]
customer.shape, order.shape, qna.shape
```




    ((5, 3), (6, 3), (3, 3))



### 2. TODO1에서 읽은 세개의 데이터셋의 정보를 확인하세요. 


```python
customer.info()
customer.head()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 5 entries, 0 to 4
    Data columns (total 3 columns):
     #   Column  Non-Null Count  Dtype 
    ---  ------  --------------  ----- 
     0   id      5 non-null      object
     1   name    5 non-null      object
     2   age     5 non-null      int64 
    dtypes: int64(1), object(2)
    memory usage: 248.0+ bytes





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>김영수</td>
      <td>33</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>박선영</td>
      <td>23</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>오정현</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>박명수</td>
      <td>40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>이철기</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div>




```python
order.info()
order.head()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 6 entries, 0 to 5
    Data columns (total 3 columns):
     #   Column       Non-Null Count  Dtype 
    ---  ------       --------------  ----- 
     0   order_id     6 non-null      int64 
     1   cust_id      6 non-null      object
     2   total_price  6 non-null      int64 
    dtypes: int64(2), object(1)
    memory usage: 272.0+ bytes





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>cust_id</th>
      <th>total_price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>id-1</td>
      <td>100000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>id-1</td>
      <td>250000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>id-2</td>
      <td>300000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>id-2</td>
      <td>15000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>id-2</td>
      <td>51000</td>
    </tr>
  </tbody>
</table>
</div>




```python
qna.info()
qna.head()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 3 entries, 0 to 2
    Data columns (total 3 columns):
     #   Column   Non-Null Count  Dtype 
    ---  ------   --------------  ----- 
     0   qna_no   3 non-null      int64 
     1   cust_id  3 non-null      object
     2   txt      3 non-null      object
    dtypes: int64(1), object(2)
    memory usage: 200.0+ bytes





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>qna_no</th>
      <th>cust_id</th>
      <th>txt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>id-4</td>
      <td>물건있나요?</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>id-4</td>
      <td>얼마에요</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>id-5</td>
      <td>반품은 어떻게 해요?</td>
    </tr>
  </tbody>
</table>
</div>




```python
print(customer.columns)
print(order.columns)
print(qna.columns)
```

    Index(['id', 'name', 'age'], dtype='object')
    Index(['order_id', 'cust_id', 'total_price'], dtype='object')
    Index(['qna_no', 'cust_id', 'txt'], dtype='object')


### 3. customer DataFrame과 order DataFrame을 고객정보는 모두 나오도록 join 하세요.


```python
cust_order_join = customer.merge(order, left_on='id', right_on='cust_id', how='left')
cust_order_join
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>age</th>
      <th>order_id</th>
      <th>cust_id</th>
      <th>total_price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>김영수</td>
      <td>33</td>
      <td>1.0</td>
      <td>id-1</td>
      <td>100000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-1</td>
      <td>김영수</td>
      <td>33</td>
      <td>2.0</td>
      <td>id-1</td>
      <td>250000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-2</td>
      <td>박선영</td>
      <td>23</td>
      <td>3.0</td>
      <td>id-2</td>
      <td>300000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-2</td>
      <td>박선영</td>
      <td>23</td>
      <td>4.0</td>
      <td>id-2</td>
      <td>15000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-2</td>
      <td>박선영</td>
      <td>23</td>
      <td>5.0</td>
      <td>id-2</td>
      <td>51000.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>id-3</td>
      <td>오정현</td>
      <td>21</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>id-4</td>
      <td>박명수</td>
      <td>40</td>
      <td>6.0</td>
      <td>id-4</td>
      <td>32000.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>id-5</td>
      <td>이철기</td>
      <td>17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
cust_order_join.query('name == "김영수"')
cust_order_join.groupby('id')['total_price'].mean()
```




    id
    id-1    175000.0
    id-2    122000.0
    id-3         NaN
    id-4     32000.0
    id-5         NaN
    Name: total_price, dtype: float64



### 4. 3번의 customer DataFrame의 index를 id컬럼으로 변경.


```python
customer2 = customer.set_index('id')
customer2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>김영수</td>
      <td>33</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>박선영</td>
      <td>23</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>오정현</td>
      <td>21</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>박명수</td>
      <td>40</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>이철기</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div>




```python
customer2.reset_index()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>age</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>김영수</td>
      <td>33</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-2</td>
      <td>박선영</td>
      <td>23</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-3</td>
      <td>오정현</td>
      <td>21</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-4</td>
      <td>박명수</td>
      <td>40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-5</td>
      <td>이철기</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div>



### 5. customer DataFrame과 qna DataFrame을 inner join 하세요.


```python
customer2.merge(qna, left_index=True, right_on='cust_id', how='inner')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>qna_no</th>
      <th>cust_id</th>
      <th>txt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>박명수</td>
      <td>40</td>
      <td>1</td>
      <td>id-4</td>
      <td>물건있나요?</td>
    </tr>
    <tr>
      <th>1</th>
      <td>박명수</td>
      <td>40</td>
      <td>2</td>
      <td>id-4</td>
      <td>얼마에요</td>
    </tr>
    <tr>
      <th>2</th>
      <td>이철기</td>
      <td>17</td>
      <td>3</td>
      <td>id-5</td>
      <td>반품은 어떻게 해요?</td>
    </tr>
  </tbody>
</table>
</div>




```python
customer2.join(qna.set_index('cust_id'), how='inner')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>qna_no</th>
      <th>txt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-4</th>
      <td>박명수</td>
      <td>40</td>
      <td>1</td>
      <td>물건있나요?</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>박명수</td>
      <td>40</td>
      <td>2</td>
      <td>얼마에요</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>이철기</td>
      <td>17</td>
      <td>3</td>
      <td>반품은 어떻게 해요?</td>
    </tr>
  </tbody>
</table>
</div>



### 6. 세개의 DataFrame을 고객정보는 모두 나오도록 join 하세요.


```python
result = customer2.join([order.set_index('cust_id'), qna.set_index('cust_id')], how='left')
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>order_id</th>
      <th>total_price</th>
      <th>qna_no</th>
      <th>txt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>김영수</td>
      <td>33</td>
      <td>1.0</td>
      <td>100000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-1</th>
      <td>김영수</td>
      <td>33</td>
      <td>2.0</td>
      <td>250000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>박선영</td>
      <td>23</td>
      <td>3.0</td>
      <td>300000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>박선영</td>
      <td>23</td>
      <td>4.0</td>
      <td>15000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>박선영</td>
      <td>23</td>
      <td>5.0</td>
      <td>51000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>오정현</td>
      <td>21</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>박명수</td>
      <td>40</td>
      <td>6.0</td>
      <td>32000.0</td>
      <td>1.0</td>
      <td>물건있나요?</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>박명수</td>
      <td>40</td>
      <td>6.0</td>
      <td>32000.0</td>
      <td>2.0</td>
      <td>얼마에요</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>이철기</td>
      <td>17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>반품은 어떻게 해요?</td>
    </tr>
  </tbody>
</table>
</div>


